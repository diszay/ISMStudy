<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#060913">
  <title>ISM v5 Master Certification Engine</title>
  
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: false, theme: 'dark', fontFamily: 'DM Mono, monospace' });</script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, useMemo } = React;

    // ─── UTILITY COMPONENTS ───────────────────────────────────────────────────
    function MermaidDiagram({ chart }) {
      const ref = useRef(null);
      useEffect(() => {
        if (ref.current && window.mermaid) {
          ref.current.removeAttribute('data-processed');
          ref.current.innerHTML = chart;
          try { window.mermaid.init(undefined, ref.current); } catch (e) { console.error(e); }
        }
      }, [chart]);
      return (
        <div className="mermaid-wrapper glass-panel" style={{padding: '24px', margin: '24px 0', background: 'rgba(0,0,0,0.4)', textAlign: 'center', overflowX: 'auto', border: '1px solid rgba(0, 118, 206, 0.3)'}}>
          <div className="mermaid" ref={ref}>{chart}</div>
        </div>
      );
    }

    // ─── MASTER QUESTION BANK (100% COMPLETE - 85 Qs) ─────────────────────────
    const MODULES = [
      { id: "m1", title: "Digital Transformation & Business Drivers", tag: "MOD 1–2", color: "#0F4C81", accent: "#0076CE", questions: [ 
        { q: "Which modern data center characteristic allows IT to function as a utility by delivering resources based on a self-service model?", opts: ["Virtualization","Orchestrated management","IT-as-a-Service","On-demand scalability"], ans: 2, rationale: "IT-as-a-Service enables IT to function as a utility by adopting the resource delivery 'as-a-service' paradigm." }, 
        { q: "In the context of Big Data, what does 'Velocity' specifically refer to?", opts: ["The total size of the dataset in Petabytes","The rate at which data is produced and the speed required for processing","The diversity of data formats (structured vs. unstructured)","The reliability and accuracy of the data source"], ans: 1, rationale: "Velocity is the rate at which data is produced, changes, and how fast it must be processed." }, 
        { q: "What is the primary benefit of Edge Computing in an IoT environment?", opts: ["Centralizing all data for better security management","Reducing bandwidth costs by performing analytics close to the data source","Replacing the need for a central cloud or data center","Increasing the complexity of the data grid"], ans: 1, rationale: "Edge computing performs analytics locally to send only meaningful data to the cloud, saving bandwidth and reducing transmission costs." }, 
        { q: "Which technology provides the 'Ultra-low latency' required for 5G ecosystems?", opts: ["4G LTE backhaul","5G mobile technology","Traditional HDD storage","SATA interfaces"], ans: 1, rationale: "5G features and reliability enable ultra-low latency for technical and business innovation." }, 
        { q: "Why is Machine Learning critical for managing modern voluminous data?", opts: ["It eliminates the need for any human oversight","It allows machines to adapt to new datasets and produce reliable outputs based on previous experiences","It reduces the physical footprint of the data center","It converts unstructured data into structured SQL tables"], ans: 1, rationale: "ML allows machines to adapt to new datasets by learning from previous experiences to produce reliable outputs." }, 
        { q: "Which modern data center characteristic helps improve business agility using predefined workflows to automate coordination?", opts: ["Virtualization","Orchestrated management","Continuous availability","Multi-layered security"], ans: 1, rationale: "Orchestrated management uses predefined workflows to automate the arrangement and coordination of component functions." }, 
        { q: "What is a key driver for organizations undertaking digital transformation?", opts: ["To eliminate all management costs","To innovate more quickly and meet customer expectations","To reduce the number of employees","To move away from software-based analysis"], ans: 1, rationale: "Organizations adopt digital transformation to meet customer expectations and innovate quickly using smarter products and analytics." }, 
        { q: "Cloud computing provides 'ubiquitous' access. What does this mean in a storage context?", opts: ["Access is restricted to internal employees only","Access is available from anywhere and anytime via the network","Data is stored on a single physical disk for safety","Only block-level data can be accessed"], ans: 1, rationale: "Cloud computing enables ubiquitous, convenient, on-demand network access to a shared pool of resources." } 
      ] },
      { id: "m2", title: "Modern Data Center Environment", tag: "MOD 3", color: "#1A3A5C", accent: "#00AEEF", questions: [ 
        { q: "What defines Hyperconverged Infrastructure (HCI) compared to Converged Infrastructure (CI)?", opts: ["CI is software-defined; HCI is hardware-defined","HCI is software-defined and integrates compute, storage, and networking into a single distributed platform","CI is more flexible and scalable than HCI","HCI requires separate management tools for every component"], ans: 1, rationale: "HCI combines compute, storage, and networking into a distributed platform managed by software, making it more flexible than CI." }, 
        { q: "In a Software-Defined Data Center (SDDC), which plane is responsible for making decisions such as where to forward a packet?", opts: ["Data plane","Management plane","Control plane","Service plane"], ans: 2, rationale: "The control layer (control plane) is responsible for making decisions such as packet forwarding." }, 
        { q: "Which compute system type is designed to be plugged into a chassis that provides power, cooling, and connectivity?", opts: ["Tower","Rack-mounted","Blade","Desktop"], ans: 2, rationale: "A blade compute system consists of an electronic circuit board (the blade) that is plugged into a chassis." }, 
        { q: "What is the primary function of a Hypervisor?", opts: ["To encrypt data at rest","To provide a software abstraction layer that allows multiple VMs to run on a single physical system","To manage the physical cooling systems of a data center","To act as the primary storage controller for a SAN"], ans: 1, rationale: "A hypervisor is the software that abstracts physical resources for virtual machines." }, 
        { q: "Which approach to building a data center allows for 'best-of-breed' component selection?", opts: ["Hyperconverged approach","Do-It-Yourself (DIY) approach","Vendor-ready solution","Data Center as a Service"], ans: 1, rationale: "The DIY approach utilizes products from respective leading vendors and provides specific functions with more options." }, 
        { q: "In the 'Greenfield' method of data center design, what is a primary advantage?", opts: ["Using existing legacy equipment to save costs","Designing a new infrastructure specifically for a purpose without legacy constraints","Integrating new software with 20-year-old hardware","Lowering the initial acquisition cost"], ans: 1, rationale: "Greenfield environments enable architects to design exactly what is required using new infrastructure built specifically for a purpose." }, 
        { q: "What does the 'Data Plane' perform in an SDDC architecture?", opts: ["Setting policies","Managing user accounts","Handling the actual data transfer/forwarding based on control plane instructions","Creating the self-service portal"], ans: 2, rationale: "The data plane (infrastructure layer) is where the actual data resides and is forwarded based on the control plane's logic." } 
      ] },
      { id: "m3", title: "Intelligent Storage Systems (ISS)", tag: "MOD 4", color: "#2D1B69", accent: "#8A2BE2", questions: [ 
        { q: "How does NVMe reduce latency compared to traditional SCSI stacks?", opts: ["By using mechanical arms","By providing a streamlined software interface for PCIe SSDs and taking advantage of parallelism","By converting block data into objects","By reducing the speed of the CPU"], ans: 1, rationale: "NVMe eliminates the SCSI bottleneck and takes advantage of microsecond latency provided by all-flash arrays." }, 
        { q: "Which RAID level provides the highest protection by supporting two simultaneous disk failures?", opts: ["RAID 0","RAID 5","RAID 6","RAID 1"], ans: 2, rationale: "RAID 6 includes a second distributed parity element to enable survival if up to two disk failures occur." }, 
        { q: "Calculate the write penalty for a RAID 5 configuration.", opts: ["2","4","6","0"], ans: 1, rationale: "In RAID 5, every write manifests as four I/O operations (two reads and two writes)." }, 
        { q: "What is the primary characteristic of Storage Class Memory (SCM)?", opts: ["It is faster than DRAM","It offers memory-like performance (faster than flash) at a storage-like cost","It is a volatile form of memory","It is only used for long-term archiving on tape"], ans: 1, rationale: "SCM features memory-like performance at storage-like cost and is over 10× faster than flash." }, 
        { q: "In a RAID 1+0 setup, if one drive in a mirrored pair fails, what happens to the data?", opts: ["All data in the RAID set is lost","Data is retrieved from the surviving mirror in the pair","The parity bit is used to reconstruct the data","The system shuts down to prevent corruption"], ans: 1, rationale: "RAID 1+0 allows data retrieval as long as one disk in each mirrored pair is functional." }, 
        { q: "What is the Write Penalty of RAID 6?", opts: ["2","4","6","1"], ans: 2, rationale: "In RAID 6, every write manifests as six I/O operations (three reads and three writes)." }, 
        { q: "Which RAID technique spreads data across multiple drives to use them in parallel?", opts: ["Mirroring","Parity","Striping","Sparing"], ans: 2, rationale: "Striping spreads data across multiple drives to use them in parallel, increasing performance." }, 
        { q: "What is a 'Stripe' in a RAID set?", opts: ["A single disk in the array","A set of aligned 'strips' that spans across all disks in the RAID set","The mathematical sum of all data","The replacement disk for a failed unit"], ans: 1, rationale: "The set of aligned strips that spans across all the disks within the RAID set is called a stripe." }, 
        { q: "Why is RAID 1 considered expensive?", opts: ["It requires complex parity calculations","It requires twice the storage capacity of the data being stored (50% usable capacity)","It has the highest write penalty (penalty of 6)","It can only use SATA drives"], ans: 1, rationale: "Mirroring (RAID 1) requires twice the storage capacity and provides only 50% usable capacity." }, 
        { q: "Which component of an ISS performs I/O interface functions and relieves the compute processor?", opts: ["Storage enclosure","Host Bus Adapter (HBA)","Disk platter","Power supply"], ans: 1, rationale: "An HBA performs I/O interface functions, relieving the processor from I/O processing workload." }, 
        { q: "What is the minimum number of disks required for RAID 5?", opts: ["2","3","4","5"], ans: 1, rationale: "RAID 5 requires a minimum of three disks." }, 
        { q: "What is the Usable Capacity formula for RAID 5?", opts: ["(n-2)/n","50%","[(n-1)/n] × 100","n × 100"], ans: 2, rationale: "The available storage capacity for RAID 5 is calculated as [(n-1)/n] × 100." }, 
        { q: "In storage tiering, where should 'frequently accessed' data be stored for optimal performance?", opts: ["Tier 3 (SATA)","Tier 2 (SAS)","Tier 1 or Tier 0 (SSD/SCM/DRAM)","Optical tape"], ans: 2, rationale: "High-performance SSDs (Tier 1/0) are used to keep frequently accessed data." }, 
        { q: "What is a 'Thick LUN'?", opts: ["A LUN that uses virtual provisioning to save space","A LUN created by traditional storage provisioning that pre-allocates all physical storage","A LUN that can only store object data","A LUN that exists only in cache"], ans: 1, rationale: "LUNs created by traditional storage provisioning methods are termed thick LUNs to distinguish them from virtual/thin LUNs." }, 
        { q: "What is the benefit of 'Sub-LUN Tiering'?", opts: ["Moving an entire LUN to a different tier","Moving specific active blocks (sub-portions) of a LUN to a higher tier while keeping inactive blocks on lower tiers","Deleting unused LUNs","Encrypting only a portion of the disk"], ans: 1, rationale: "Sub-LUN tiering moves active data segments within a LUN to Tier 0 for performance while moving inactive portions to lower tiers." } 
      ] },
      { id: "m4", title: "Block, File & Object Storage", tag: "MOD 5", color: "#1B4332", accent: "#00C7B1", questions: [ 
        { q: "What is a key attribute of Block-based storage?", opts: ["Data is accessed via a global namespace","The file system is managed by the storage system","LUNs appear to the server as internal physical disks","Data is stored with extensive custom metadata"], ans: 2, rationale: "Block-based storage system LUNs appear to the server as internal physical disks." }, 
        { q: "Which storage architecture uses a 'Flat Address Space' instead of a hierarchy?", opts: ["Block storage","File-based storage (NAS)","Object-based storage (OSD)","Internal DAS"], ans: 2, rationale: "An OSD stores data using a flat address space where objects exist at the same level." }, 
        { q: "What is the purpose of an 'Object ID'?", opts: ["To determine the physical sector of the HDD","To act as a unique identifier for retrieval in a flat address space","To identify the user's login credentials","To count the number of blocks in a stripe"], ans: 1, rationale: "The Object ID is used to access the storage location for the object and its metadata in a flat repository." }, 
        { q: "Unified Storage provides access to which types of data?", opts: ["Block only","Block and File only","Block, File, and Object","Object only"], ans: 2, rationale: "Unified storage is a single system that consolidates block-level, file-level, and object-level access." }, 
        { q: "What problem does a 'Scale-out NAS' address?", opts: ["The inability to use IP networks","Performance bottlenecks and capacity limits of a single controller by pooling multiple nodes","The high cost of SATA drives","The lack of encryption"], ans: 1, rationale: "Scale-out NAS achieves high scalability by pooling multiple nodes into a clustered system." }, 
        { q: "In an OSD, what is stored in 'Metadata'?", opts: ["The raw binary data only","Contextual information like creation date, owner, and custom attributes","The RAID parity bit","The operating system's kernel"], ans: 1, rationale: "Metadata adds important information associated with the data, such as creation date and owner." }, 
        { q: "What is the function of an 'OSD Gateway'?", opts: ["To convert object data into physical tape","To provide a translation layer between traditional protocols (iSCSI/NFS) and cloud object storage (REST/SOAP)","To act as a physical firewall for the SAN","To manage the electricity of the storage array"], ans: 1, rationale: "OSD gateways provide a translation layer between iSCSI, FC, NFS, CIFS and cloud-based object storage interfaces." }, 
        { q: "Which protocol is commonly used to access object storage via web applications?", opts: ["SCSI","Fibre Channel","REST/SOAP APIs","SMB/CIFS only"], ans: 2, rationale: "Most object-based storage systems support REST or SOAP interfaces for web and mobile access." }, 
        { q: "What does a 'Scale-up' architecture involve?", opts: ["Adding more nodes to a cluster","Adding more capacity (disks) to an existing controller until it reaches its limit","Using only cloud-based storage","Switching from HDD to SSD"], ans: 1, rationale: "'Scale-up' involves increasing the capacity of a fixed unit, vs scale-out which adds nodes." }, 
        { q: "In unified storage, what is the 'Utilization Penalty'?", opts: ["The power consumed by redundant fans","Stranded capacity in separate storage silos that cannot be shared","The time taken to calculate RAID parity","The cost of licensing multiple GUIs"], ans: 1, rationale: "Unified storage eliminates the capacity utilization penalty associated with separate block, file, and object systems." } 
      ] },
      { id: "m5", title: "SAN Connectivity: FC, IP, FCoE", tag: "MOD 6–7", color: "#4A1942", accent: "#E03C71", questions: [ 
        { q: "What is the function of an 'E_Port' in an FC SAN?", opts: ["To connect a host to a switch","To connect a storage system to a switch","To provide an Interswitch Link (ISL) between two switches","To act as a generic port for any device"], ans: 2, rationale: "An E_Port (Expansion Port) forms a connection between two FC switches via an ISL." }, 
        { q: "Which protocol is used to extend FC SANs over long distances by tunneling through IP networks?", opts: ["iSCSI","FCoE","FCIP","NVMe/TCP"], ans: 2, rationale: "FCIP is a tunneling protocol used to interconnect distributed FC SAN islands over an IP network for long distances." }, 
        { q: "What is the primary role of a 'Converged Network Adapter' (CNA)?", opts: ["To speed up HDD rotations","To replace both a NIC and an FC HBA by providing LAN and FC SAN connectivity through one port","To act as a gateway for iSCSI","To provide power to the switch"], ans: 1, rationale: "A CNA replaces the NIC and FC HBA, connecting to both FC SAN and Ethernet LAN through a single port." }, 
        { q: "What is 'Zoning' in an FC SAN?", opts: ["Defining the physical temperature zones of a rack","Creating a logical private path between node ports to restrict communication","Spreading data across disks","Calculating the distance between data centers"], ans: 1, rationale: "Zoning is a logical private path between node ports in a fabric." }, 
        { q: "Which NVMe-oF addressing convention is used to identify a target?", opts: ["IQN","WWN","NQN","IP Address"], ans: 2, rationale: "NVMe-oF uses the NVMe Qualified Name (NQN) convention to identify a target." }, 
        { q: "What is a 'WWN' (World Wide Name)?", opts: ["A 64-bit unique identifier for FC components","The website address of the storage vendor","A protocol for object storage","The name of the data center"], ans: 0, rationale: "WWN refers to the unique 64-bit identifier used for FC device identification." }, 
        { q: "What is the Write Penalty for RAID 1?", opts: ["4","2","1","6"], ans: 1, rationale: "In RAID 1, every write manifests as two I/O operations (two writes to the mirror)." }, 
        { q: "In FCoE, what happens to the Fibre Channel frame?", opts: ["It is converted into an iSCSI packet","It is encapsulated unchanged into an Ethernet frame","It is stripped of its header","It is compressed to half its size"], ans: 1, rationale: "FCoE encapsulates unchanged FC frames into Ethernet frames as the payload." }, 
        { q: "Which port type on an FC switch can function as either an E_Port or an F_Port?", opts: ["N_Port","G_Port","NI_Port","Trunk Port"], ans: 1, rationale: "A G_Port (Generic Port) can operate as either an E_Port or an F_Port and determines its functionality during initialization." }, 
        { q: "What is an 'ISL' (Interswitch Link)?", opts: ["A link between a host and a switch","A link between a switch and a storage array","A link that connects two switches together","A software connection between two VMs"], ans: 2, rationale: "ISLs are established between E_Ports to expand the fabric." }, 
        { q: "Which SAN topology uses departmental switches at the edge and enterprise directors at the core?", opts: ["Single Switch","Full Mesh","Core-Edge","Partial Mesh"], ans: 2, rationale: "Core-edge topology uses departmental switches at the edge and enterprise directors at the core to increase connectivity while conserving ports." }, 
        { q: "Why would an organization choose iSCSI over FC SAN?", opts: ["It is much faster than 128 Gb/s FC","It is more cost-effective as it uses existing IP/Ethernet infrastructure and skills","It does not require any security","It only works with tape drives"], ans: 1, rationale: "iSCSI is more cost-effective than FC because users can leverage their existing IP network and management skills." }, 
        { q: "What is the function of the 'FC-2' layer in the FC protocol stack?", opts: ["Mapping interfaces","Routing, framing, and flow control","Bit and frame synchronization","Defining the physical media/cables"], ans: 1, rationale: "The FC-2 layer handles routing, flow control, and frame structure." }, 
        { q: "What is 'Link Aggregation' (Port-Channel)?", opts: ["Splitting one link into four","Combining multiple physical ISLs into a single logical link for higher throughput","Deleting redundant links to save power","Assigning one port to two different hosts"], ans: 1, rationale: "Link aggregation combines multiple ISLs into a logical link to increase throughput and ensure even utilization." }, 
        { q: "Which protocol allows NVMe to be transported over a standard Ethernet network using TCP?", opts: ["FC-NVMe","NVMe/TCP","iSCSI","FCoE"], ans: 1, rationale: "NVMe/TCP enables an end-to-end NVMe-oF solution using TCP over an Ethernet fabric." } 
      ] },
      { id: "m6", title: "Software-Defined Storage & Network", tag: "MOD 8", color: "#1C3144", accent: "#F2A900", questions: [ 
        { q: "In Software-Defined Networking (SDN), what is the 'Infrastructure Layer'?", opts: ["The layer that sets business policies","The layer where physical networking devices reside and perform data forwarding","The layer that manages the hypervisors","The GUI for the administrator"], ans: 1, rationale: "The infrastructure layer (data plane) is responsible for packet forwarding as instructed by the control layer." }, 
        { q: "What is a major driver for Software-Defined Storage (SDS)?", opts: ["To lock users into one hardware vendor","To pool heterogeneous storage resources and automate allocation based on policy","To eliminate the need for any storage software","To force all data onto HDD devices"], ans: 1, rationale: "SDS pools heterogeneous resources and allocates them based on policy, reducing complexity and avoiding vendor lock-in." }, 
        { q: "Which SDN layer is responsible for the 'Control Logic'?", opts: ["Application layer","Control layer","Infrastructure layer","Physical layer"], ans: 1, rationale: "The control layer is responsible for the decisions and logic like packet forwarding." }, 
        { q: "Can SDS run on 'Commodity Hardware'?", opts: ["No, it requires specialized proprietary arrays","Yes, it allows using industry-standard hardware to build storage pools","Only if the hardware is older than 5 years","It only runs in the public cloud"], ans: 1, rationale: "SDS enables the use of heterogeneous (including commodity) resources by abstracting them through software." }, 
        { q: "What is 'Abstraction' in the context of SDS?", opts: ["Hiding the physical characteristics of storage from the user","Deleting data after 30 days","Mapping every block to a physical tape","Increasing the cost of the hardware"], ans: 0, rationale: "Abstraction is a core concept of SDDC/SDS that decouples management from the underlying physical infrastructure." } 
      ] },
      { id: "m7", title: "Business Continuity & Data Protection", tag: "MOD 9–10", color: "#1A1A2E", accent: "#E94560", questions: [ 
        { q: "What does 'RPO' (Recovery Point Objective) define?", opts: ["The time it takes to recover a system","The maximum amount of data loss a business can endure (measured in time)","The total cost of the backup software","The number of employees required for a restore"], ans: 1, rationale: "RPO defines the amount of data loss that a business can endure." }, 
        { q: "What does 'RTO' (Recovery Time Objective) define?", opts: ["The point-in-time data is recovered to","The duration of time within which systems must be recovered after an outage","The speed of the WAN link","The age of the backup tapes"], ans: 1, rationale: "RTO is the time within which systems/applications must be recovered." }, 
        { q: "What is 'Erasure Coding'?", opts: ["Deleting data once it is no longer needed","A space-optimal redundancy method that divides data into segments and coding fragments (n = m + k)","Mirroring data three times","Encoding data into Morse code for security"], ans: 1, rationale: "Erasure coding provides space-optimal redundancy by dividing data into m segments and k coding fragments." }, 
        { q: "In the erasure coding example m=9, k=3, how many drive failures can the system survive?", opts: ["9","3","12","1"], ans: 1, rationale: "The system can survive k drive failures; in this case, k=3." }, 
        { q: "What is 'Dynamic Disk Sparing'?", opts: ["Manually replacing a drive every year","Automatically replacing a failed drive with a pre-configured spare to protect against data loss","Using one disk for two different RAID sets","Increasing the speed of a disk during peak hours"], ans: 1, rationale: "Dynamic disk sparing automatically replaces a failed drive with a spare drive to protect against data loss." }, 
        { q: "What is a 'Snapshot'?", opts: ["A physical photograph of the data center","A point-in-time (PIT) copy of a LUN or file system","A full backup to a tape drive","A way to increase disk capacity"], ans: 1, rationale: "Snapshots are point-in-time (PIT) versions of data used for protection." }, 
        { q: "Local Replication refers to copying data where?", opts: ["To a data center on another continent","Within the same storage system or data center","To a public cloud only","To a user's USB drive"], ans: 1, rationale: "Local replication involves creating PIT copies within the same array or site." }, 
        { q: "Why is 'In-order delivery' important in SAN replication?", opts: ["To make the data easier to read","To ensure data consistency at the target site, especially for database applications","To reduce the power usage of the link","To identify the owner of the data"], ans: 1, rationale: "Protocols like FC and TCP (used in FCIP) ensure in-order delivery, which is required for normal SAN operation and consistency." }, 
        { q: "What is the main goal of Business Continuity (BC)?", opts: ["To double the company's revenue","To ensure operations continue during and after an outage","To move all servers to the cloud","To eliminate all IT employees"], ans: 1, rationale: "BC is the practice of ensuring operations continue during an outage." }, 
        { q: "What is 'Disaster Recovery' (DR)?", opts: ["A set of policies to restore IT infrastructure after a major failure or natural disaster","Deleting old data","Buying new laptops for employees","Moving a rack to a different room"], ans: 0, rationale: "DR involves policies and procedures for restoring IT after a disaster." } 
      ] },
      { id: "m8", title: "Security & Storage Management", tag: "MOD 11–12", color: "#1B0000", accent: "#FF5A00", questions: [ 
        { q: "Which statement is true regarding Role-Based Access Control (RBAC)?", opts: ["One person should be able to both specify and carry out an action","Maximum privileges are always assigned to every user","No individual can both specify an action and carry it out (separation of duties)","RBAC is only used for cloud storage"], ans: 2, rationale: "A key principle of RBAC is the separation of duties, meaning no individual can both specify and carry out an action." }, 
        { q: "What is 'Authentication'?", opts: ["Restricting what a user can do","The process of verifying a user's identity credentials","Logging all transactions for auditing","Creating a new IT service"], ans: 1, rationale: "Authentication is the process to ensure that users or assets verify their identity credentials." }, 
        { q: "In storage security, what is 'Governance'?", opts: ["Verifying a password","Logging transactions","Determining the purpose, strategy, and operational rules by which companies are directed","Encrypting a disk"], ans: 2, rationale: "Governance determines the purpose, strategy, and rules by which companies are managed." }, 
        { q: "What is 'Auditing' in a storage environment?", opts: ["Deleting old files","The logging of all transactions to assess the effectiveness of security mechanisms","Assigning IP addresses","Buying new hardware"], ans: 1, rationale: "Auditing is the logging of all transactions for assessing security effectiveness." }, 
        { q: "What information does 'Infrastructure Discovery' identify?", opts: ["The names of all employees","Configuration, connectivity, capacity, and dependencies (physical-to-virtual)","The stock price of the vendor","The weather at the data center site"], ans: 1, rationale: "Infrastructure discovery identifies configuration, connectivity, capacity, and physical-to-virtual dependencies." }, 
        { q: "What is the purpose of a 'Chargeback Report'?", opts: ["To report resource consumption per business unit for billing","To report if a hacker entered the system","To list the serial numbers of all disks","To report the temperature of the server room"], ans: 0, rationale: "A chargeback report reports resource consumption per business unit." }, 
        { q: "Which management process determines the optimal amount of resources required for IT operations?", opts: ["Problem management","Availability management","Capacity management","Incident management"], ans: 2, rationale: "Capacity management determines the optimal amount of resources required to meet IT needs." }, 
        { q: "What is the goal of 'Problem Management'?", opts: ["To fix a single user's mouse","To prevent incidents that share common symptoms or root causes from reoccurring","To buy more storage","To create a new VM"], ans: 1, rationale: "Problem management prevents incidents with common root causes from reoccurring." }, 
        { q: "What is 'Multi-factor Authentication' (MFA)?", opts: ["Using two different passwords","Using more than one factor (something you know and something you have) to verify identity","Having two people log in at the same time","Logging in from two different countries"], ans: 1, rationale: "MFA requires more than one factor to verify identity." }, 
        { q: "What is 'Data at Rest Encryption' (D@RE)?", opts: ["Encrypting data as it travels over the internet","Securing data specifically when it is stored on physical media","Deleting data when it is not being used","Hiding the physical disk in a safe"], ans: 1, rationale: "D@RE secures data while it is residing on storage media." }, 
        { q: "Which 'Plane' in an SDDC architecture is used for configuring the system and changing policies?", opts: ["Control plane","Management plane","Data plane","Service plane"], ans: 1, rationale: "The management plane is used for configuring the system and changing policies." }, 
        { q: "What is an 'SLA' (Service Level Agreement)?", opts: ["A type of storage cable","A contract that defines the parameters of service between a provider and a user","A RAID level","A security password"], ans: 1, rationale: "An SLA defines the parameters of service and requirements between parties." }, 
        { q: "In storage management, what does 'Availability Management' ensure?", opts: ["That there is enough disk space","That IT resources are available to meet business requirements defined in SLAs","That the data is encrypted","That the vendor is paid"], ans: 1, rationale: "Availability management ensures that IT resources meet the availability requirements of the business." }, 
        { q: "What is 'Change Management' responsible for?", opts: ["Replacing the batteries in the UPS","Standardizing the process for efficient handling of changes to the IT infrastructure","Counting the change in the company's vending machine","Changing the administrator's password every day"], ans: 1, rationale: "Change management provides standardized methods for efficient handling of all changes to infrastructure." }, 
        { q: "'Configuration Items' (CIs) are tracked in which management process?", opts: ["Performance management","Configuration management","Security management","Financial management"], ans: 1, rationale: "Configuration management tracks and manages information about the components (CIs) of the infrastructure." } 
      ] }
    ];

    const ALL_QUESTIONS = MODULES.flatMap((m) => m.questions.map((q, i) => ({ ...q, moduleTag: m.tag, moduleAccent: m.accent, moduleId: m.id, qId: `${m.id}-${i}` })));

    // ─── DEEP-DIVE STUDY NOTES (ALL 12 MODULES WITH ENHANCED DIAGRAMS) ────────
    const ENRICHED_STUDY_NOTES = [
      {
        id: "m1", title: "Digital Transformation & Business Drivers", tag: "MOD 1-2", color: "#0F4C81",
        diagram: `flowchart TD
          subgraph env [Innovation Enablers]
            DT[Digital Transformation] --> CC[Cloud Computing]
            DT --> BD[Big Data & Analytics]
            DT --> IoT[IoT & Edge Computing]
            DT --> AI[AI & Machine Learning]
          end
          classDef plain fill:transparent,stroke:#0F4C81,stroke-width:2px,color:#fff;
          class DT,CC,BD,IoT,AI plain;
        `,
        concepts: [
          {
            id: "m1c1", title: "Data vs. Information",
            eli5: "Data is like raw ingredients (flour, eggs, sugar). Information is the baked cake. You can't serve raw flour to the boss; you have to process it into a cake first.",
            expert: "Data consists of raw facts stored as binary values. Information is data that has been processed and analyzed to enable strategic business decision-making.",
            takeaway: "Storage systems must ensure data is highly available and performant enough to be processed into actionable information."
          },
          {
            id: "m1c2", title: "Cloud Computing Essential Characteristics",
            eli5: "The Cloud is like renting a car instead of buying one. You get it instantly (On-Demand), drive it anywhere (Network Access), upgrade to an SUV if needed (Elasticity), and only pay for the miles driven (Measured Service).",
            expert: "The NIST defines cloud computing through 5 characteristics: On-demand self-service, Broad network access, Resource pooling, Rapid elasticity, and Measured service.",
            takeaway: "Without 'Measured Service' and a 'Self-Service Portal', you just have virtualization, not a true Cloud architecture."
          },
          {
            id: "m1c3", title: "Big Data & Edge Computing",
            eli5: "If you have a billion thermometers sending data, your internet will crash. Edge computing puts a mini-brain right next to the thermometers to filter the junk and only send important alerts to the cloud.",
            expert: "To handle extreme Velocity in IoT networks, Edge Computing performs analytics close to the data source (sensors/gateways) to drastically reduce bandwidth consumption and achieve ultra-low latency.",
            takeaway: "Edge computing decentralizes processing to solve the bandwidth bottlenecks inherent in massive IoT deployments."
          }
        ]
      },
      {
        id: "m2", title: "Modern Data Center Environment", tag: "MOD 3", color: "#00AEEF",
        diagram: `flowchart TD
          subgraph sddc [Software-Defined Data Center]
            M[Management Plane: vCenter/APIs] --> C[Control Plane: Routing Logic]
            C --> D[Data Plane: Hardware Forwarding]
            D --> P[Physical Compute/Storage]
          end
          classDef plain fill:transparent,stroke:#00AEEF,stroke-width:2px,color:#fff;
          class M,C,D,P plain;
        `,
        concepts: [
          {
            id: "m2c1", title: "Software-Defined Data Center (SDDC) Planes",
            eli5: "Think of an SDDC like a restaurant. The 'Management Plane' is the menu. The 'Control Plane' is the Head Chef deciding how to cook it. The 'Data Plane' is the kitchen staff actually doing the physical work.",
            expert: "A 'Southbound API' connects the Control plane to the Data plane (hardware). A 'Northbound API' connects the Management plane to the Control plane. Bare-Metal hypervisors (Type 1) install directly on the hardware.",
            takeaway: "Decoupling allows centralized controllers to update multi-vendor hardware simultaneously."
          },
          {
            id: "m2c2", title: "HCI vs. CI Environments",
            eli5: "Converged Infrastructure (CI) is buying a pre-built house. Hyperconverged Infrastructure (HCI) is buying standard LEGO blocks and letting software build the house for you dynamically.",
            expert: "CI is a hardware-defined, pre-packaged rack from specific vendors. HCI (e.g., Dell PowerFlex) pools standard commodity x86 servers using a software layer, abstracting compute and storage resources.",
            takeaway: "HCI provides massive scalability. You plug in another standard node, and the software balances the resources."
          },
          {
            id: "m2c3", title: "Virtual Machines vs. Containers",
            eli5: "A Virtual Machine is like giving everyone their own separate house (full OS). A Container is like an apartment building where everyone shares the same plumbing (shared OS kernel).",
            expert: "VMs use a hypervisor to abstract physical hardware, requiring a heavy guest OS. Containers (e.g., Docker) abstract the OS kernel itself. Containers boot in milliseconds but lack strict hardware-level fault isolation.",
            takeaway: "Containers are the foundation of Cloud-Native microservices because they are portable and scalable."
          }
        ]
      },
      {
        id: "m3", title: "Intelligent Storage Systems", tag: "MOD 4", color: "#8A2BE2",
        concepts: [
          {
            id: "m3c1", title: "Cache Vaulting & Write-Back",
            eli5: "Write-Back cache is like taking a customer's money and saying 'Got it!' instantly, then putting it in the register later. It's fast, but dangerous if the power goes out before you put it away.",
            expert: "Modern arrays exclusively use 'Write-Back' cache. To prevent data loss during power failure, ISS uses 'Cache Vaulting'. A battery keeps DRAM alive long enough to dump 'dirty' cache pages into a non-volatile M.2 NVMe SSD (the Vault).",
            takeaway: "Cache Vaulting guarantees zero data loss while allowing the array to operate at memory-speeds."
          },
          {
            id: "m3c2", title: "NVMe Protocol Overhaul",
            eli5: "SCSI is a one-lane dirt road for data. NVMe is a 65,000-lane superhighway built specifically for fast flash drives.",
            expert: "Traditional SSDs were bottlenecked by SCSI/SATA protocols (1 queue, 32 commands). NVMe maps directly to the CPU's PCIe lanes, unlocking flash parallel processing. It supports up to 65,535 queues.",
            takeaway: "NVMe drops latency from milliseconds to microseconds by eliminating the SCSI translation overhead."
          }
        ]
      },
      {
        id: "m5", title: "SAN Connectivity", tag: "MOD 6-7", color: "#E03C71",
        diagram: `flowchart LR
          S((Server HBA N_Port)) -->|FLOGI / PLOGI| E[Edge Switch F_Port]
          E -->|ISL via E_Port| C[Core Switch E_Port]
          classDef plain fill:transparent,stroke:#E03C71,stroke-width:2px,color:#fff;
          class S,E,C plain;
        `,
        concepts: [
          {
            id: "m5c1", title: "FC Fabric Login Sequence",
            eli5: "When a server plugs into a SAN, it does three things: Gets an IP address from the switch, shakes hands with the storage array, and agrees on what language to speak.",
            expert: "A server executes 3 logins. 1) FLOGI (Fabric Login) to the switch's F_Port to receive its 24-bit FC Address. 2) PLOGI (Port Login) directly to the target array's N_Port. 3) PRLI (Process Login) to exchange SCSI capabilities.",
            takeaway: "Switches must use E_Ports to communicate with each other to expand the fabric (ISL)."
          },
          {
            id: "m5c2", title: "FCoE & Lossless Ethernet",
            eli5: "FCoE lets you run storage traffic over a standard internet cable instead of a dedicated fiber optic cable, saving tons of money on wiring.",
            expert: "FCoE encapsulates pure FC frames into Ethernet frames. Because standard Ethernet drops packets, FCoE requires Converged Enhanced Ethernet (CEE). CEE uses Priority-based Flow Control (PFC) to pause specific traffic classes.",
            takeaway: "FCoE allows one Converged Network Adapter (CNA) to handle both LAN and SAN traffic reliably."
          }
        ]
      },
      {
        id: "m6", title: "Software-Defined Storage", tag: "MOD 8", color: "#F2A900",
        diagram: `flowchart TD
          subgraph sds [Software-Defined Storage]
            CP[Control Plane - Policy/Provisioning] -->|APIs| DP[Data Plane]
            DP --> Pool1[Commodity SSDs]
            DP --> Pool2[Commodity HDDs]
            DP --> Pool3[Cloud Storage]
          end
          classDef plain fill:transparent,stroke:#F2A900,stroke-width:2px,color:#fff;
          class CP,DP,Pool1,Pool2,Pool3 plain;
        `,
        concepts: [
          {
            id: "m6c1", title: "SDS Core Principles",
            eli5: "SDS is like a universal remote control. Instead of buying expensive, proprietary storage boxes from one vendor, you buy cheap, generic hard drives and use the 'universal remote' software to make them act like enterprise storage.",
            expert: "Software-Defined Storage abstracts the control plane from the data plane. It pools heterogeneous storage resources (any vendor, any type) and automates allocation based on policy.",
            takeaway: "SDS eliminates vendor lock-in and reduces hardware costs by relying on software intelligence instead of proprietary ASICs."
          }
        ]
      },
      {
        id: "m7", title: "Data Protection & Replication", tag: "MOD 9-10", color: "#E94560",
        concepts: [
          {
            id: "m7c1", title: "Snapshots: CoW vs RoW",
            eli5: "Copy-on-Write (CoW) copies the old document before you write a new one. Redirect-on-Write (RoW) just gives you a blank sheet of paper and changes the index pointer.",
            expert: "Copy-on-Write requires 3 I/Os for an update (Read original, Write original to snapshot pool, Write new data). Redirect-on-Write requires only 1 I/O (Writes new data to a new block and updates the pointer).",
            takeaway: "RoW offers significantly higher performance for write-intensive workloads."
          },
          {
            id: "m7c2", title: "Continuous Data Protection (CDP)",
            eli5: "Standard backups are like taking a photo every hour. CDP is like a security camera recording a video. You can rewind to any exact second.",
            expert: "CDP relies on a 'Write Splitter' installed in the host or fabric. The Splitter duplicates every write operation. One copy goes to primary storage, the other to the CDP Appliance which time-stamps it and stores it in a Journal volume.",
            takeaway: "CDP enables microsecond recovery granularity, guaranteeing virtually zero RPO against ransomware."
          }
        ]
      },
      {
        id: "m8", title: "Security Architectures", tag: "MOD 11-12", color: "#FF5A00",
        diagram: `flowchart LR
          Prod[Production Data Center] -->|Air-Gapped Sync| Vault[Cyber Recovery Vault]
          subgraph VaultEnv [Isolated Vault]
            Vault --> Copy[Create PIT Copy]
            Copy --> Lock[Apply WORM Lock]
            Lock --> Scan[AI Malware Scan]
          end
          classDef plain fill:transparent,stroke:#FF5A00,stroke-width:2px,color:#fff;
          class Prod,Vault,Copy,Lock,Scan plain;
        `,
        concepts: [
          {
            id: "m8c1", title: "Advanced Cyber Recovery Vault",
            eli5: "A Vault is a disconnected panic room. Even if hackers burn down your entire data center, the Vault stays hidden and safe with a pristine copy of your data.",
            expert: "The vault operates on a 'Sync-Copy-Lock' mechanism. 1) Sync: Vault opens port and pulls data. 2) Copy: Generates a PIT copy inside the Vault. 3) Lock: Applies WORM (Write-Once-Read-Many) retention, making the copy cryptographically immutable.",
            takeaway: "Air-gapping and WORM locks are the only guaranteed defense against targeted ransomware attacking backup catalogs."
          }
        ]
      }
    ];

    // ─── MASTER GLOSSARY (ALL 87 ACRONYMS FULLY RESTORED) ──────────────────────
    const GLOSSARY = {
      "Master Acronym Index": [
        { term: "API", def: "Application Programming Interface" },
        { term: "ATA", def: "Advanced Technology Attachment" },
        { term: "CD", def: "Compact Disc" },
        { term: "CIA", def: "Confidentiality, Integrity, and Availability" },
        { term: "CIAA", def: "Confidentiality, Integrity, Availability, and Accountability" },
        { term: "CIFS", def: "Common Internet File System" },
        { term: "CI", def: "Configuration Item / Converged Infrastructure" },
        { term: "CMS", def: "Configuration Management System" },
        { term: "D@RE", def: "Data at Rest Encryption" },
        { term: "DAS", def: "Direct-Attached Storage" },
        { term: "DMZ", def: "Demilitarized Zone" },
        { term: "DVD", def: "Digital Versatile Disc" },
        { term: "EUI", def: "Extended Unique Identifier" },
        { term: "FC", def: "Fibre Channel" },
        { term: "FCIP", def: "Fibre Channel over IP" },
        { term: "FCoE", def: "Fibre Channel over Ethernet" },
        { term: "FCP", def: "Fibre Channel Protocol" },
        { term: "FTP", def: "File Transfer Protocol" },
        { term: "GRC", def: "Governance, Risk, and Compliance" },
        { term: "GUI", def: "Graphical User Interface" },
        { term: "HBA", def: "Host Bus Adapter" },
        { term: "HCI", def: "Hyperconverged Infrastructure" },
        { term: "HDD", def: "Hard Disk Drive" },
        { term: "HTTP", def: "Hypertext Transfer Protocol" },
        { term: "IA", def: "Information Availability" },
        { term: "IDC", def: "International Data Corporation" },
        { term: "IDS", def: "Intrusion Detection System" },
        { term: "IoT", def: "Internet of Things" },
        { term: "IP", def: "Internet Protocol" },
        { term: "IPS", def: "Intrusion Prevention System" },
        { term: "IQN", def: "iSCSI Qualified Name" },
        { term: "iSCSI", def: "Internet Small Computer System Interface" },
        { term: "ISL", def: "Interswitch Link" },
        { term: "ISS", def: "Intelligent Storage System" },
        { term: "LAN", def: "Local Area Network" },
        { term: "LUN", def: "Logical Unit Number" },
        { term: "MAC", def: "Media Access Control" },
        { term: "MRI", def: "Magnetic Resonance Imaging" },
        { term: "MTBF", def: "Mean Time Between Failure" },
        { term: "MTTR", def: "Mean Time To Repair" },
        { term: "NAA", def: "Network Address Authority" },
        { term: "NAS", def: "Network Attached Storage" },
        { term: "NFS", def: "Network File System" },
        { term: "NIC", def: "Network Interface Card" },
        { term: "NQN", def: "NVMe Qualified Name" },
        { term: "NVM", def: "Non-Volatile Memory" },
        { term: "NVMe", def: "Non-Volatile Memory express" },
        { term: "NVMe-oF", def: "NVMe over Fabrics" },
        { term: "NVRAM", def: "Non-Volatile Random Access Memory" },
        { term: "OS", def: "Operating System" },
        { term: "OSD", def: "Object-Based Storage Device" },
        { term: "OSI", def: "Open Systems Interconnection" },
        { term: "PCIe", def: "Peripheral Component Interconnect Express" },
        { term: "RAID", def: "Redundant Array of Independent Disks" },
        { term: "RAM", def: "Random Access Memory" },
        { term: "REST", def: "Representational State Transfer" },
        { term: "RPO", def: "Recovery Point Objective" },
        { term: "RTO", def: "Recovery Time Objective" },
        { term: "SAN", def: "Storage Area Network" },
        { term: "SAS", def: "Serial Attached SCSI" },
        { term: "SATA", def: "Serial Advanced Technology Attachment" },
        { term: "SCM", def: "Storage Class Memory" },
        { term: "SCSI", def: "Small Computer System Interface" },
        { term: "SDDC", def: "Software-Defined Data Center" },
        { term: "SDN", def: "Software-Defined Networking" },
        { term: "SDS", def: "Software-Defined Storage" },
        { term: "SFSS", def: "SmartFabric Storage Software" },
        { term: "SLA", def: "Service Level Agreement" },
        { term: "SMB", def: "Server Message Block" },
        { term: "SOAP", def: "Simple Object Access Protocol" },
        { term: "SPOF", def: "Single Point of Failure" },
        { term: "SRM", def: "Storage Resource Manager" },
        { term: "SSD", def: "Solid-State Drive" },
        { term: "SSL", def: "Secure Sockets Layer" },
        { term: "TCP", def: "Transmission Control Protocol" },
        { term: "TCP/IP", def: "Transmission Control Protocol/Internet Protocol" },
        { term: "TOE", def: "TCP Offload Engine" },
        { term: "USB", def: "Universal Serial Bus" },
        { term: "VLAN", def: "Virtual Local Area Network" },
        { term: "VM", def: "Virtual Machine" },
        { term: "VSAN", def: "Virtual Storage Area Network" },
        { term: "WAN", def: "Wide Area Network" },
        { term: "WWN", def: "World Wide Name" },
        { term: "WWNN", def: "World Wide Node Name" },
        { term: "WWPN", def: "World Wide Port Name" },
        { term: "XML", def: "Extensible Markup Language" },
        { term: "ZB", def: "Zettabytes" }
      ],
      "RAID Quick Reference": [
        { term: "RAID 0", def: "Striping only. No fault tolerance. Write penalty: 0. Usable: 100%" },
        { term: "RAID 1", def: "Mirroring. Survives 1 failure. Write penalty: 2. Usable: 50%" },
        { term: "RAID 5", def: "Striping + 1 parity. Survives 1 failure. Write penalty: 4. Usable: [(n-1)/n]×100. Min disks: 3" },
        { term: "RAID 6", def: "Striping + 2 parity. Survives 2 failures. Write penalty: 6. Usable: [(n-2)/n]×100. Min disks: 4" },
        { term: "RAID 1+0", def: "Mirrored stripes. Survives 1 per mirror pair. Write penalty: 2. Usable: 50%. Min disks: 4" }
      ]
    };

    // ─── POMODORO PRODUCTIVITY TIMER ──────────────────────────────────────────
    function PomodoroTimer() {
      const [timeLeft, setTimeLeft] = useState(25 * 60);
      const [isActive, setIsActive] = useState(false);
      const [isBreak, setIsBreak] = useState(false);

      useEffect(() => {
        let interval;
        if (isActive && timeLeft > 0) {
          interval = setInterval(() => setTimeLeft(t => t - 1), 1000);
        } else if (isActive && timeLeft === 0) {
          setIsActive(false);
          if (!isBreak) { alert("25 minutes complete! Take a 5-minute break."); setIsBreak(true); setTimeLeft(5 * 60); } 
          else { alert("Break over. Back to studying!"); setIsBreak(false); setTimeLeft(25 * 60); }
        }
        return () => clearInterval(interval);
      }, [isActive, timeLeft, isBreak]);

      const toggleTimer = () => setIsActive(!isActive);
      const resetTimer = () => { setIsActive(false); setIsBreak(false); setTimeLeft(25 * 60); };

      return (
        <div className="pomo-container">
          <div className="pomo-label">{isBreak ? "☕ Break" : "⏱ Focus"}</div>
          <div className="pomo-time">{String(Math.floor(timeLeft / 60)).padStart(2, '0')}:{String(timeLeft % 60).padStart(2, '0')}</div>
          <div className="pomo-controls">
            <button onClick={toggleTimer}>{isActive ? "⏸" : "▶"}</button>
            <button onClick={resetTimer}>↺</button>
          </div>
        </div>
      );
    }

    // ─── PROGRESSIVE DISCLOSURE ACCORDION (HYBRID TOGGLE & LOCK) ──────────────
    function StudyAccordion({ concept, color, isMastered, onToggleMaster, userXP }) {
      const [isOpen, setIsOpen] = useState(false);
      const isNuanceUnlocked = isMastered || userXP >= 150;
      const [viewMode, setViewMode] = useState(isNuanceUnlocked ? 'expert' : 'eli5');

      return (
        <div className={`guide-accordion ${isOpen ? 'open' : ''} ${isMastered ? 'mastered' : ''}`}>
          <div className="ga-header" onClick={() => setIsOpen(!isOpen)}>
            <div className="ga-title-area">
              <div className="ga-check" style={{borderColor: isMastered ? '#22C55E' : 'rgba(255,255,255,0.2)', background: isMastered ? 'rgba(34,197,94,0.2)' : 'transparent'}}>
                {isMastered && <span style={{color: '#22C55E'}}>✓</span>}
              </div>
              <div>
                <h4 className="ga-title">{concept.title}</h4>
                <p className="ga-summary">{concept.summary}</p>
              </div>
            </div>
            <div className="ga-chevron">{isOpen ? '−' : '+'}</div>
          </div>
          
          <div className="ga-body" style={{ display: isOpen ? 'block' : 'none' }}>
            <div className="ga-content">
              <div className="view-toggle">
                <button className={viewMode === 'eli5' ? 'active' : ''} onClick={() => setViewMode('eli5')}>Beginner (ELI5)</button>
                <button className={`${viewMode === 'expert' ? 'active' : ''} ${!isNuanceUnlocked ? 'locked-btn' : ''}`} onClick={() => { if(isNuanceUnlocked) setViewMode('expert'); }}>
                  {isNuanceUnlocked ? 'Architect (Dell Nuance)' : '🔒 Architect (Locked)'}
                </button>
              </div>

              <div className="ga-how fade-in" key={viewMode}>
                <strong>{viewMode === 'eli5' ? "Simple Analogy:" : "Architecture Nuance:"}</strong><br/>
                {viewMode === 'eli5' ? concept.eli5 : (isNuanceUnlocked ? concept.expert : "Gain 150 XP or Mark as Mastered to unlock expert technical details.")}
              </div>
              
              <div className="ga-takeaway">💡 <strong>Key Takeaway:</strong> {concept.takeaway}</div>
            </div>
            <div className="ga-actions">
              <button className={`btn-mastery ${isMastered ? 'active' : ''}`} onClick={(e) => { e.stopPropagation(); onToggleMaster(); }}>
                {isMastered ? '✓ Concept Mastered (+20 XP)' : 'Mark as Mastered (Unlocks Nuance)'}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // ─── SPACED REPETITION FLASHCARD COMPONENT ───────────────────────────────
    function FlashcardDeck({ items, fcState, setFcState }) {
      const [index, setIndex] = useState(0);
      const [flipped, setFlipped] = useState(false);

      // Filter out cards the user has already marked as mastered
      const activeCards = items.filter(item => fcState[item.term] !== 'mastered');
      
      if (activeCards.length === 0) {
        return (
          <div className="flashcard-container" style={{textAlign: 'center', padding: '40px'}}>
            <h2 style={{color: '#22C55E'}}>🎉 All Acronyms Mastered!</h2>
            <button className="btn-secondary" style={{marginTop: 20}} onClick={() => setFcState({})}>Reset Deck</button>
          </div>
        );
      }

      // Safeguard index
      const safeIndex = index >= activeCards.length ? 0 : index;

      const handleMark = (status) => {
        setFlipped(false);
        const currentTerm = activeCards[safeIndex].term;
        setTimeout(() => {
          setFcState(prev => ({ ...prev, [currentTerm]: status }));
          setIndex(prev => prev >= activeCards.length - 1 ? 0 : prev);
        }, 150);
      };

      return (
        <div className="flashcard-container">
          <div className="flashcard-progress">
            <span style={{color: '#60A5FA'}}>{items.length - activeCards.length} Mastered</span> 
            <span style={{margin: '0 12px'}}>|</span> 
            {activeCards.length} Cards Remaining
          </div>
          <div className={`flashcard ${flipped ? 'flipped' : ''}`} onClick={() => setFlipped(!flipped)}>
            <div className="flashcard-inner">
              <div className="flashcard-front">
                <div className="fc-hint">Click to flip</div>
                <div className="fc-term">{activeCards[safeIndex].term}</div>
              </div>
              <div className="flashcard-back">
                <div className="fc-def">{activeCards[safeIndex].def}</div>
              </div>
            </div>
          </div>
          <div className="flashcard-actions">
            <button className="btn-secondary" onClick={() => handleMark('review')} style={{color: '#FCA5A5', borderColor: 'rgba(239,68,68,0.3)'}}>✗ Review Later</button>
            <button className="btn-secondary" onClick={() => handleMark('mastered')} style={{color: '#86EFAC', borderColor: 'rgba(34,197,94,0.3)'}}>✓ I Know This</button>
          </div>
        </div>
      );
    }

    // ─── MAIN APPLICATION ─────────────────────────────────────────────────────
    function ISMStudyApp() {
      const [view, setView] = useState("home");
      
      // PERSISTENT STATE
      const [scores, setScores] = useState(() => { try { const s = localStorage.getItem('ism_scores'); return s ? JSON.parse(s) : {}; } catch { return {}; } });
      const [missedQuestions, setMissedQuestions] = useState(() => { try { const s = localStorage.getItem('ism_missed'); return s ? JSON.parse(s) : []; } catch { return []; } });
      const [guideProgress, setGuideProgress] = useState(() => { try { const s = localStorage.getItem('ism_guide_prog'); return s ? JSON.parse(s) : {}; } catch { return {}; } });
      const [questionStats, setQuestionStats] = useState(() => { try { const s = localStorage.getItem('ism_qstats'); return s ? JSON.parse(s) : {}; } catch { return {}; } });
      const [fcState, setFcState] = useState(() => { try { const s = localStorage.getItem('ism_fcstate'); return s ? JSON.parse(s) : {}; } catch { return {}; } });
      
      useEffect(() => { localStorage.setItem('ism_scores', JSON.stringify(scores)); }, [scores]);
      useEffect(() => { localStorage.setItem('ism_missed', JSON.stringify(missedQuestions)); }, [missedQuestions]);
      useEffect(() => { localStorage.setItem('ism_guide_prog', JSON.stringify(guideProgress)); }, [guideProgress]);
      useEffect(() => { localStorage.setItem('ism_qstats', JSON.stringify(questionStats)); }, [questionStats]);
      useEffect(() => { localStorage.setItem('ism_fcstate', JSON.stringify(fcState)); }, [fcState]);

      // EXAM READINESS CALCULATOR
      const calculateExamReadiness = () => {
        const totalQs = ALL_QUESTIONS.length;
        const correctQs = Object.values(scores).reduce((a, s) => a + s.correct, 0);
        const quizPct = totalQs === 0 ? 0 : (correctQs / totalQs);

        let totalConcepts = 0;
        let masteredConcepts = 0;
        ENRICHED_STUDY_NOTES.forEach(m => {
          totalConcepts += m.concepts.length;
          masteredConcepts += m.concepts.filter(c => guideProgress[c.id]).length;
        });
        const guidePct = totalConcepts === 0 ? 0 : (masteredConcepts / totalConcepts);

        const totalFc = GLOSSARY["Master Acronym Index"].length;
        const masteredFc = Object.values(fcState).filter(v => v === 'mastered').length;
        const fcPct = totalFc === 0 ? 0 : (masteredFc / totalFc);

        // Weighted Score: 40% Quizzes, 40% Guide Mastery, 20% Vocab
        return Math.round((quizPct * 40) + (guidePct * 40) + (fcPct * 20));
      };

      const examReadiness = calculateExamReadiness();
      const userXP = (Object.values(scores).reduce((a, s) => a + s.correct, 0) * 10) + (Object.keys(guideProgress).filter(k => guideProgress[k]).length * 20);

      // UI STATE
      const [activeGuideModule, setActiveGuideModule] = useState(ENRICHED_STUDY_NOTES[0]);
      const [quizMode, setQuizMode] = useState("module");
      const [activeModule, setActiveModule] = useState(null);
      const [currentQ, setCurrentQ] = useState(0);
      const [selected, setSelected] = useState(null);
      const [answered, setAnswered] = useState(false);
      const [sessionAnswers, setSessionAnswers] = useState([]);
      const [showResults, setShowResults] = useState(false);
      const [questions, setQuestions] = useState([]);
      const [examTimer, setExamTimer] = useState(0);
      const [examActive, setExamActive] = useState(false);
      const [glossarySearch, setGlossarySearch] = useState("");

      const totalAnswered = Object.values(scores).reduce((a, s) => a + (s.correct + s.wrong), 0);
      const totalCorrect = Object.values(scores).reduce((a, s) => a + s.correct, 0);

      useEffect(() => { let interval; if (examActive) interval = setInterval(() => setExamTimer(t => t + 1), 1000); return () => clearInterval(interval); }, [examActive]);
      useEffect(() => {
        const handleKeyDown = (e) => {
          if (view !== "quiz" || showResults || !questions[currentQ]) return;
          if (answered && e.key === "Enter") { nextQuestion(); return; }
          if (!answered) {
            const keyMap = { 'a': 0, 'b': 1, 'c': 2, 'd': 3 };
            const idx = keyMap[e.key.toLowerCase()];
            if (idx !== undefined && idx < questions[currentQ].opts.length) handleAnswer(idx);
          }
        };
        window.addEventListener("keydown", handleKeyDown); return () => window.removeEventListener("keydown", handleKeyDown);
      }, [view, showResults, currentQ, answered, questions]);

      const toggleMastery = (conceptId) => setGuideProgress(prev => ({ ...prev, [conceptId]: !prev[conceptId] }));
      const calculateGuideProgress = (module) => { const t = module.concepts.length; const m = module.concepts.filter(c => guideProgress[c.id]).length; return { m, t, pct: t === 0 ? 0 : Math.round((m/t)*100) }; };

      const handleAnswer = (idx) => {
        if (answered) return;
        setSelected(idx); setAnswered(true);
        const q = questions[currentQ];
        const correct = idx === q.ans;
        const targetModId = quizMode === "module" ? activeModule.id : q.moduleId;

        setScores(prev => {
          const s = prev[targetModId] || { correct: 0, wrong: 0 };
          return { ...prev, [targetModId]: { correct: s.correct + (correct ? 1 : 0), wrong: s.wrong + (correct ? 0 : 1) } };
        });

        setQuestionStats(prev => {
          const s = prev[q.qId] || { hits: 0, misses: 0 };
          return { ...prev, [q.qId]: { hits: s.hits + (correct ? 1 : 0), misses: s.misses + (correct ? 0 : 1) } };
        });

        setSessionAnswers(prev => [...prev, { q: q.q, correct, correctAns: q.opts[q.ans], chosenAns: q.opts[idx], rationale: q.rationale }]);
        if (!correct) setMissedQuestions(prev => prev.some(mq => mq.q === q.q) ? prev : [...prev, q]);
      };

      const formatTime = (s) => `${String(Math.floor(s/60)).padStart(2,'0')}:${String(s%60).padStart(2,'0')}`;
      const nextQuestion = () => { if (currentQ + 1 >= questions.length) { setShowResults(true); setExamActive(false); window.scrollTo(0,0); } else { setCurrentQ(c => c + 1); setSelected(null); setAnswered(false); window.scrollTo(0,0); } };
      
      const startFullExam = () => { setQuestions([...ALL_QUESTIONS].sort(() => Math.random() - 0.5)); setCurrentQ(0); setSelected(null); setAnswered(false); setSessionAnswers([]); setShowResults(false); setExamTimer(0); setActiveModule(null); setQuizMode("fullExam"); setExamActive(true); setView("quiz"); window.scrollTo(0,0); };
      const startModuleQuiz = (module) => { setActiveModule(module); setQuestions(module.questions.map((q, i) => ({ ...q, originalIndex: i }))); setCurrentQ(0); setSelected(null); setAnswered(false); setSessionAnswers([]); setShowResults(false); setQuizMode("module"); setView("quiz"); window.scrollTo(0,0); };
      const startMissedQuiz = () => { if (!missedQuestions.length) return; setQuestions([...missedQuestions].sort(() => Math.random() - 0.5)); setCurrentQ(0); setSelected(null); setAnswered(false); setSessionAnswers([]); setShowResults(false); setActiveModule(null); setQuizMode("missed"); setView("quiz"); window.scrollTo(0,0); };

      const startSmartDrill = () => {
        const sortedQs = [...ALL_QUESTIONS].sort((a, b) => {
          const statA = questionStats[a.qId] || { hits: 0, misses: 0 };
          const statB = questionStats[b.qId] || { hits: 0, misses: 0 };
          const rateA = statA.misses / (statA.hits + statA.misses || 1);
          const rateB = statB.misses / (statB.hits + statB.misses || 1);
          if (rateB !== rateA) return rateB - rateA;
          return (statA.hits + statA.misses) - (statB.hits + statB.misses);
        }).slice(0, 15);
        setQuestions(sortedQs); setCurrentQ(0); setSelected(null); setAnswered(false); setSessionAnswers([]); setShowResults(false); setActiveModule(null); setQuizMode("smartDrill"); setExamActive(true); setView("quiz"); window.scrollTo(0,0); 
      };

      const getGradeColor = (pct) => pct >= 90 ? "#22C55E" : pct >= 75 ? "#0076CE" : pct >= 60 ? "#F59E0B" : "#EF4444";

      const filteredGlossary = Object.entries(GLOSSARY).reduce((acc, [section, items]) => {
        const filtered = items.filter(i => !glossarySearch || i.term.toLowerCase().includes(glossarySearch.toLowerCase()) || i.def.toLowerCase().includes(glossarySearch.toLowerCase()));
        if (filtered.length) acc[section] = filtered;
        return acc;
      }, {});

      return (
        <div className="app">
          <nav className="nav">
            <div className="nav-brand">ISM<span style={{color: '#0076CE'}}>v5</span></div>
            <div className="nav-tabs">
              {[["home","Dashboard"],["guide","Adaptive Guide"],["flashcards","Flashcards"],["quiz-select","Exam Engine"],["glossary","Glossary"]].map(([v,l]) => (
                <button key={v} className={`nav-tab ${view === v || (v === "quiz-select" && view === "quiz") ? "active" : ""}`} onClick={() => { setView(v === "quiz-select" ? "quiz-select" : v); window.scrollTo(0,0); }}>{l}</button>
              ))}
            </div>
            <div className="nav-actions">
              <PomodoroTimer />
            </div>
          </nav>

          {/* ── DASHBOARD ── */}
          {view === "home" && (
            <div className="home fade-in">
              <div className="readiness-panel glass-panel">
                <div className="rp-left">
                  <div className="rp-title">Overall Exam Readiness</div>
                  <div className="rp-sub">Calculated via Quiz Accuracy, Concept Mastery, and Vocabulary Retention.</div>
                </div>
                <div className="rp-right">
                  <div className="rp-score" style={{color: getGradeColor(examReadiness)}}>{examReadiness}%</div>
                </div>
              </div>
              
              <div className="home-hero" style={{marginTop: 32}}>
                <div className="hero-tag">DELL EMC &middot; ISM v5 &middot; AHEAD LAUNCH PROGRAM</div>
                <h1 className="hero-title">Storage Infrastructure<br /><span>Certification Prep</span></h1>
              </div>

              <div className="stats-row">
                <div className="stat-card glass-panel"><div className="stat-num">{ALL_QUESTIONS.length}</div><div className="stat-label">TOTAL QS</div></div>
                <div className="stat-card glass-panel"><div className="stat-num">{MODULES.length}</div><div className="stat-label">MODULES</div></div>
                <div className="stat-card glass-panel">
                  <div className="stat-num" style={{color: totalAnswered ? (totalCorrect/totalAnswered >= 0.75 ? "#22C55E" : "#F59E0B") : "#0076CE"}}>
                    {totalAnswered ? `${Math.round((totalCorrect/totalAnswered)*100)}%` : "—"}
                  </div>
                  <div className="stat-label">QUIZ SCORE</div>
                </div>
                <div className="stat-card glass-panel"><div className="stat-num" style={{color: missedQuestions.length > 0 ? "#EF4444" : "#22C55E"}}>{missedQuestions.length}</div><div className="stat-label">MISSED</div></div>
              </div>

              <div className="action-row">
                <button className="btn-primary" onClick={startSmartDrill}>🧠 Algorithm Smart Drill (15 Qs)</button>
                <button className="btn-secondary" onClick={() => setView('quiz-select')}>▶ Full Exams & Modules</button>
                <button className="btn-secondary" onClick={() => setView('flashcards')}>🗂 Practice Flashcards</button>
              </div>

              <div className="section-title" style={{marginTop: 48}}>MODULE PROFICIENCY</div>
              <div className="modules-grid">
                {MODULES.map((m) => {
                  const s = scores[m.id];
                  const total = s ? s.correct + s.wrong : 0;
                  const pctDone = total / m.questions.length * 100;
                  return (
                    <div key={m.id} className="module-card glass-panel" style={{"--accent": m.accent}} onClick={() => startModuleQuiz(m)}>
                      <div className="module-tag" style={{color: m.accent}}>{m.tag}</div>
                      <div className="module-title">{m.title}</div>
                      <div className="module-meta">
                        <span className="module-count">{m.questions.length} questions</span>
                        {s && <span style={{fontFamily:"'DM Mono', monospace", fontSize:12, color: s.correct/total >= 0.75 ? "#22C55E" : "#F59E0B"}}>{Math.round(s.correct/total*100)}%</span>}
                        <span className="module-arrow">→</span>
                      </div>
                      {total > 0 && <div className="module-progress"><div className="module-progress-fill" style={{width:`${pctDone}%`, background: m.accent}} /></div>}
                    </div>
                  );
                })}
              </div>
            </div>
          )}

          {/* ── EXAM SELECTOR ── */}
          {view === "quiz-select" && (
            <div className="home fade-in">
              <div className="home-hero">
                <div className="hero-tag">EXAM ENGINE</div>
                <h1 className="hero-title">Choose Your<br /><span>Practice Mode</span></h1>
              </div>
              <div className="action-row" style={{marginBottom: 40}}>
                <button className="btn-primary" onClick={startFullExam}>▶ Full Timed Exam (85 Qs)</button>
                <button className="btn-secondary" onClick={startSmartDrill} style={{borderColor: '#8A2BE2', color: '#C084FC'}}>🧠 Algorithm Smart Drill</button>
                {missedQuestions.length > 0 && <button className="btn-secondary" onClick={startMissedQuiz}>↺ Review Missed ({missedQuestions.length})</button>}
              </div>
              <div className="section-title">PRACTICE BY MODULE</div>
              <div className="modules-grid">
                {MODULES.map((m) => {
                  const s = scores[m.id]; const total = s ? s.correct + s.wrong : 0; const pctDone = total / m.questions.length * 100;
                  return (
                    <div key={m.id} className="module-card glass-panel" style={{"--accent": m.accent}} onClick={() => startModuleQuiz(m)}>
                      <div className="module-tag" style={{color: m.accent}}>{m.tag}</div>
                      <div className="module-title">{m.title}</div>
                      <div className="module-meta">
                        <span className="module-count">{m.questions.length} questions</span>
                        {s && <span style={{fontFamily:"'DM Mono', monospace", fontSize:12, color: s.correct/total >= 0.75 ? "#22C55E" : "#F59E0B"}}>{Math.round(s.correct/total*100)}%</span>}
                        <span className="module-arrow">→</span>
                      </div>
                      {total > 0 && <div className="module-progress"><div className="module-progress-fill" style={{width:`${pctDone}%`, background: m.accent}} /></div>}
                    </div>
                  );
                })}
              </div>
            </div>
          )}

          {/* ── ADAPTIVE STUDY GUIDE ── */}
          {view === "guide" && (
            <div className="guide-layout fade-in">
              <div className="guide-sidebar glass-panel">
                <div className="sidebar-title">MODULE SELECTOR</div>
                {ENRICHED_STUDY_NOTES.map(mod => {
                  const prog = calculateGuideProgress(mod);
                  return (
                    <button key={mod.id} className={`sidebar-btn ${activeGuideModule.id === mod.id ? 'active' : ''}`} onClick={() => { setActiveGuideModule(mod); window.scrollTo(0,0); }}>
                      <div className="sb-text"><span style={{color: mod.color, marginRight: 8, fontSize: 10}}>●</span>{mod.tag}</div>
                      {prog.m > 0 && <div className="sb-prog" style={{color: prog.pct === 100 ? '#22C55E' : 'var(--muted)'}}>{prog.m}/{prog.t}</div>}
                    </button>
                  )
                })}
              </div>
              
              <div className="guide-content">
                <div className="gc-header glass-panel" style={{borderTop: `3px solid ${activeGuideModule.color}`}}>
                  <div className="hero-tag" style={{color: activeGuideModule.color}}>{activeGuideModule.tag}</div>
                  <h2 className="hero-title" style={{fontSize: 28, margin: 0}}>{activeGuideModule.title}</h2>
                  <div className="mastery-tracker">
                    <div style={{display: 'flex', justifyContent: 'space-between', marginBottom: 8}}>
                      <div className="mt-text">Module Mastery</div>
                      <div className="mt-text" style={{color: calculateGuideProgress(activeGuideModule).pct === 100 ? '#22C55E' : 'var(--text)'}}>{calculateGuideProgress(activeGuideModule).pct}%</div>
                    </div>
                    <div className="mt-bar"><div className="mt-fill" style={{width: `${calculateGuideProgress(activeGuideModule).pct}%`, background: activeGuideModule.color}} /></div>
                  </div>
                </div>

                {activeGuideModule.diagram && <MermaidDiagram chart={activeGuideModule.diagram} />}

                <div className="accordion-list">
                  {activeGuideModule.concepts.map((concept) => (
                    <StudyAccordion 
                      key={concept.id} 
                      concept={concept} 
                      color={activeGuideModule.color} 
                      isMastered={!!guideProgress[concept.id]} 
                      onToggleMaster={() => toggleMastery(concept.id)} 
                      userXP={userXP}
                    />
                  ))}
                </div>
              </div>
            </div>
          )}

          {/* ── FLASHCARDS ── */}
          {view === "flashcards" && (
            <div className="home fade-in">
              <div className="home-hero" style={{textAlign: 'center', marginBottom: 40}}>
                <div className="hero-tag">RAPID MEMORIZATION</div>
                <h1 className="hero-title">Acronym & Concept <span>Flashcards</span></h1>
                <p className="hero-sub" style={{margin: '0 auto'}}>Drill the 87 Dell EMC acronyms required to pass the exam. Mastered cards will be removed from your active deck.</p>
              </div>
              <FlashcardDeck items={GLOSSARY["Master Acronym Index"]} fcState={fcState} setFcState={setFcState} />
            </div>
          )}

          {/* ── EXAM ENGINE ── */}
          {view === "quiz" && !showResults && questions[currentQ] && (
            <div className="quiz-wrap fade-in">
              {quizMode !== "module" && (
                <div className="exam-bar glass-panel">
                  <div className={`timer ${examTimer > 4500 ? 'danger' : ''}`}>{formatTime(examTimer)}</div>
                  <div className="exam-progress">{currentQ + 1} / {questions.length}</div>
                  <div style={{flex:1}} />
                  <button className="btn-secondary" style={{padding:'8px 16px', fontSize:12, minWidth: 0}} onClick={() => { setShowResults(true); setExamActive(false); }}>End Exam</button>
                </div>
              )}
              
              <div className="quiz-header glass-panel">
                <button className="quiz-back" onClick={() => { setView("quiz-select"); setExamActive(false); }}>← Exit</button>
                <div className="quiz-title">{quizMode === "fullExam" ? "Full Exam Simulation" : quizMode === "smartDrill" ? "Spaced Repetition Drill" : activeModule?.title}</div>
                <div className="quiz-progress-text">{currentQ + 1} / {questions.length}</div>
              </div>

              <div className="progress-bar"><div className="progress-fill" style={{width: `${(currentQ / questions.length) * 100}%`, background: activeModule?.accent || "#0076CE"}} /></div>

              <div className="question-card glass-panel">
                <div className="q-num">QUESTION {currentQ + 1} <span style={{color: questions[currentQ].moduleAccent, marginLeft: 8}}>{questions[currentQ].moduleTag}</span></div>
                <div className="q-text">{questions[currentQ].q}</div>
                <div className="options">
                  {questions[currentQ].opts.map((opt, i) => {
                    let cls = "option-btn";
                    if (answered) {
                      if (i === questions[currentQ].ans) cls += " correct";
                      else if (i === selected) cls += " wrong";
                    }
                    return (
                      <button key={i} className={cls} onClick={() => handleAnswer(i)} disabled={answered}>
                        <div className="option-letter">{String.fromCharCode(65+i)}</div>
                        <div className="option-text">{opt}</div>
                      </button>
                    );
                  })}
                </div>
                {answered && (
                  <div className="rationale fade-in">
                    <strong>{selected === questions[currentQ].ans ? "✓ Correct! " : selected === null ? "— Skipped. " : "✗ Incorrect. "}</strong>{questions[currentQ].rationale}
                  </div>
                )}
              </div>

              <div className="quiz-actions">
                {answered ? (
                  <button className="btn-primary" onClick={nextQuestion}>
                    {currentQ + 1 >= questions.length ? "See Results →" : "Next Question →"} <span className="keyboard-hint">(Enter)</span>
                  </button>
                ) : (
                  <button className="btn-secondary" onClick={() => { setSelected(questions[currentQ].ans); setAnswered(true); setSessionAnswers(prev => [...prev, { q: questions[currentQ].q, correct: false, correctAns: questions[currentQ].opts[questions[currentQ].ans], chosenAns: "—SKIPPED—", rationale: questions[currentQ].rationale }]); setMissedQuestions(prev => { const exists = prev.some(mq => mq.q === questions[currentQ].q); return exists ? prev : [...prev, questions[currentQ]]; }); }}>Skip / Reveal</button>
                )}
              </div>
            </div>
          )}

          {/* ── EXAM RESULTS ── */}
          {view === "quiz" && showResults && (
            <div className="quiz-wrap fade-in">
              <div className="results-card glass-panel">
                <div className="results-score" style={{color: getGradeColor(Math.round((sessionAnswers.filter(a=>a.correct).length / questions.length) * 100))}}>{Math.round((sessionAnswers.filter(a=>a.correct).length / questions.length) * 100)}%</div>
                <div className="results-grade" style={{color: getGradeColor(Math.round((sessionAnswers.filter(a=>a.correct).length / questions.length) * 100))}}>SESSION COMPLETE</div>
                {quizMode !== "module" && <div style={{fontFamily:"'DM Mono', monospace", color:'#00AEEF', marginBottom:24}}>Time Elapsed: {formatTime(examTimer)}</div>}
              </div>
              <div className="action-row" style={{justifyContent: 'center', marginBottom: 40}}>
                <button className="btn-secondary" onClick={() => { setView("quiz-select"); setExamActive(false); }}>← Return to Exam Engine</button>
              </div>
              {sessionAnswers.map((a, i) => (
                <div key={i} className="review-item glass-panel">
                  <span className="review-icon" style={{color: a.correct ? '#22C55E' : '#EF4444'}}>{a.correct ? "✓" : "✗"}</span>
                  <div>
                    <div className="review-q"><strong style={{color: 'white'}}>Q{i+1}: {a.q}</strong></div>
                    {!a.correct && <div className="review-q" style={{color:'#FCA5A5', marginTop:6}}>Your answer: {a.chosenAns}</div>}
                    <div className="review-q" style={{color:'#86EFAC', marginTop:4}}>Correct: {a.correctAns}</div>
                    <div className="review-q" style={{marginTop:8, color: 'var(--muted)'}}>{a.rationale}</div>
                  </div>
                </div>
              ))}
            </div>
          )}

          {/* ── GLOSSARY ── */}
          {view === "glossary" && (
            <div className="glossary-wrap fade-in">
              <div className="home-hero" style={{marginBottom: 32}}>
                <div className="hero-tag">QUICK REFERENCE</div>
                <h2 className="hero-title" style={{fontSize: '32px'}}>Master Glossary</h2>
              </div>

              <div className="section-title">RAID WRITE PENALTIES</div>
              <div className="quick-ref-grid">
                {[["RAID 0","0 — No parity","#22C55E"],["RAID 1","2 — Mirror writes","#0076CE"],["RAID 5","4 — R+R+W+W","#8A2BE2"],["RAID 6","6 — R+R+R+W+W+W","#E03C71"],["RAID 1+0","2 — Mirror writes","#F2A900"]].map(([name, val, color]) => (
                  <div key={name} className="qr-card glass-panel">
                    <div className="qr-title">{name}</div>
                    <div className="qr-val" style={{color, fontSize:15}}>{val}</div>
                  </div>
                ))}
              </div>

              <input className="search-bar glass-panel" type="text" placeholder="Search 80+ Acronyms and definitions..." value={glossarySearch} onChange={e => setGlossarySearch(e.target.value)} />
              {Object.entries(filteredGlossary).map(([section, items]) => (
                <div key={section} className="glossary-section">
                  <div className="gloss-section-title">{section.toUpperCase()}</div>
                  <div className="gloss-grid">
                    {items.map(item => (
                      <div key={item.term} className="gloss-item glass-panel">
                        <div className="gloss-term">{item.term}</div>
                        <div className="gloss-def">{item.def}</div>
                      </div>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<ISMStudyApp />);
  </script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Syne:wght@400;600;700;800&family=Inter:wght@400;500;600&display=swap');
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root { --bg: #060913; --bg-panel: rgba(15, 22, 40, 0.65); --border: rgba(255, 255, 255, 0.08); --border-hover: rgba(0, 118, 206, 0.4); --text: #E8ECF5; --muted: #8A9BBF; --primary: #0076CE; }
    body { background: var(--bg); background-image: radial-gradient(circle at top right, rgba(15, 22, 40, 0.8), transparent 40%), radial-gradient(circle at bottom left, rgba(10, 16, 29, 0.8), transparent 40%); background-attachment: fixed; color: var(--text); font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; -webkit-tap-highlight-color: transparent; }
    .fade-in { animation: fadeIn 0.4s ease forwards; }
    .app { min-height: 100vh; display: flex; flex-direction: column; }
    .glass-panel { background: var(--bg-panel); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border: 1px solid var(--border); border-radius: 16px; transition: all 0.3s ease; }
    .glass-panel:hover { border-color: var(--border-hover); box-shadow: 0 8px 32px rgba(0,0,0,0.25); }

    .nav { position: sticky; top: 0; z-index: 100; background: rgba(6, 9, 19, 0.85); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); padding: 0 24px; display: flex; align-items: center; justify-content: space-between; height: 70px; }
    .nav-brand { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 20px; letter-spacing: -0.5px; margin-right: 16px; }
    .nav-tabs { display: flex; gap: 8px; overflow-x: auto; -ms-overflow-style: none; scrollbar-width: none; }
    .nav-tabs::-webkit-scrollbar { display: none; }
    .nav-tab { font-family: 'DM Mono', monospace; font-size: 12px; font-weight: 500; padding: 10px 16px; border-radius: 8px; border: 1px solid transparent; cursor: pointer; background: transparent; color: var(--muted); transition: all 0.2s; white-space: nowrap; }
    .nav-tab:hover { color: var(--text); background: rgba(255,255,255,0.04); }
    .nav-tab.active { background: rgba(0, 118, 206, 0.15); color: #60A5FA; border-color: rgba(0, 118, 206, 0.4); }
    .nav-actions { margin-left: 16px; }

    /* POMODORO */
    .pomo-container { display: flex; align-items: center; gap: 12px; background: rgba(0,0,0,0.3); padding: 6px 12px; border-radius: 8px; border: 1px solid var(--border); }
    .pomo-label { font-family: 'DM Mono', monospace; font-size: 10px; color: var(--muted); text-transform: uppercase; }
    .pomo-time { font-family: 'DM Mono', monospace; font-size: 16px; font-weight: 500; color: #F59E0B; width: 50px; text-align: center; }
    .pomo-controls button { background: rgba(255,255,255,0.05); border: none; color: white; border-radius: 4px; padding: 4px 8px; cursor: pointer; transition: all 0.2s; }
    .pomo-controls button:hover { background: rgba(255,255,255,0.15); }

    /* FLASHCARDS */
    .flashcard-container { max-width: 600px; margin: 0 auto; perspective: 1000px; }
    .flashcard-progress { text-align: center; font-family: 'DM Mono', monospace; font-size: 12px; color: var(--muted); margin-bottom: 16px; letter-spacing: 2px; text-transform: uppercase; }
    .flashcard { width: 100%; height: 350px; cursor: pointer; position: relative; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); transform-style: preserve-3d; }
    .flashcard.flipped { transform: rotateY(180deg); }
    .flashcard-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; }
    .flashcard-front, .flashcard-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; background: var(--bg-panel); border: 1px solid var(--primary); border-radius: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); }
    .flashcard-front { background: linear-gradient(135deg, rgba(15, 22, 40, 0.9), rgba(0, 118, 206, 0.1)); }
    .flashcard-back { background: rgba(15, 22, 40, 0.95); transform: rotateY(180deg); border-color: #8A2BE2; }
    .fc-hint { position: absolute; top: 20px; font-family: 'DM Mono', monospace; font-size: 11px; color: var(--muted); letter-spacing: 1px; }
    .fc-term { font-family: 'Syne', sans-serif; font-size: 40px; font-weight: 800; color: #60A5FA; }
    .fc-def { font-size: 20px; line-height: 1.6; color: white; }
    .flashcard-actions { display: flex; justify-content: center; gap: 16px; margin-top: 40px; }

    .home, .quiz-wrap, .glossary-wrap { padding: 48px 24px 80px; max-width: 960px; margin: 0 auto; width: 100%; }
    .hero-tag { font-family: 'DM Mono', monospace; font-size: 11px; color: var(--primary); letter-spacing: 2px; margin-bottom: 16px; font-weight: 500; }
    .hero-title { font-family: 'Syne', sans-serif; font-size: clamp(32px, 6vw, 56px); font-weight: 800; line-height: 1.1; letter-spacing: -1px; margin-bottom: 20px; }
    .hero-title span { background: linear-gradient(135deg, #0076CE 0%, #8A2BE2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-sub { color: var(--muted); font-size: 16px; line-height: 1.6; max-width: 580px; }
    .section-title { font-family: 'DM Mono', monospace; font-size: 12px; color: var(--muted); letter-spacing: 2px; margin-bottom: 20px; margin-top: 48px; border-bottom: 1px solid var(--border); padding-bottom: 12px; }
    
    /* READINESS METER */
    .readiness-panel { display: flex; align-items: center; justify-content: space-between; padding: 24px 32px; border-left: 4px solid var(--primary); margin-bottom: 40px; }
    .rp-title { font-family: 'Syne', sans-serif; font-size: 20px; font-weight: 700; color: white; margin-bottom: 4px; }
    .rp-sub { font-family: 'DM Mono', monospace; font-size: 12px; color: var(--muted); }
    .rp-score { font-family: 'Syne', sans-serif; font-size: 48px; font-weight: 800; line-height: 1; }

    .stats-row { display: flex; gap: 16px; margin-bottom: 40px; flex-wrap: wrap; }
    .stat-card { flex: 1; min-width: 140px; padding: 24px 20px; text-align: center; display: flex; flex-direction: column; justify-content: center; }
    .stat-num { font-family: 'Syne', sans-serif; font-size: 36px; font-weight: 800; color: var(--primary); }
    .stat-label { font-size: 11px; color: var(--muted); margin-top: 10px; font-family: 'DM Mono', monospace; letter-spacing: 1px; }
    
    .action-row { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 24px; }
    .btn-primary, .btn-secondary { padding: 16px 28px; border-radius: 12px; cursor: pointer; font-family: 'DM Mono', monospace; font-size: 14px; font-weight: 500; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
    .btn-primary { background: linear-gradient(135deg, #0076CE, #2563EB); border: none; color: white; box-shadow: 0 4px 14px rgba(0, 118, 206, 0.3); }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0, 118, 206, 0.5); }
    .btn-secondary { background: var(--bg-panel); border: 1px solid var(--border); color: var(--text); backdrop-filter: blur(8px); }
    .btn-secondary:hover { border-color: rgba(255,255,255,0.25); background: rgba(255,255,255,0.08); }
    
    .modules-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
    .module-card { padding: 32px 28px; cursor: pointer; position: relative; overflow: hidden; display: flex; flex-direction: column; }
    .module-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--accent); }
    .module-card:hover { transform: translateY(-4px); border-color: var(--accent); }
    .module-tag { font-family: 'DM Mono', monospace; font-size: 11px; font-weight: 500; letter-spacing: 1.5px; margin-bottom: 16px; }
    .module-title { font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 700; margin-bottom: 24px; line-height: 1.4; color: white; }
    .module-meta { display: flex; align-items: center; justify-content: space-between; margin-top: auto; }
    .module-count { font-size: 13px; color: var(--muted); }
    .module-arrow { color: var(--muted); }
    .module-progress { margin-top: 16px; height: 4px; background: rgba(0,0,0,0.4); border-radius: 2px; }
    .module-progress-fill { height: 100%; border-radius: 2px; transition: width 0.6s ease; }

    .guide-layout { display: flex; max-width: 1100px; margin: 0 auto; padding: 40px 24px; gap: 32px; align-items: flex-start; }
    .guide-sidebar { width: 280px; padding: 24px 16px; flex-shrink: 0; position: sticky; top: 88px; }
    .sidebar-title { font-family: 'DM Mono', monospace; font-size: 11px; color: var(--muted); letter-spacing: 2px; margin-bottom: 16px; padding-left: 12px; }
    .sidebar-btn { width: 100%; text-align: left; background: transparent; border: 1px solid transparent; color: var(--muted); padding: 12px; border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 500; transition: all 0.2s; }
    .sidebar-btn:hover { background: rgba(255,255,255,0.05); color: var(--text); }
    .sidebar-btn.active { background: rgba(255,255,255,0.08); color: white; border-color: rgba(255,255,255,0.1); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
    .sb-text { display: flex; align-items: center; }
    .sb-prog { font-family: 'DM Mono', monospace; font-size: 11px; background: rgba(0,0,0,0.3); padding: 4px 8px; border-radius: 6px; }
    .guide-content { flex: 1; min-width: 0; }
    .gc-header { padding: 32px; margin-bottom: 24px; }
    .mt-text { font-family: 'DM Mono', monospace; font-size: 12px; color: var(--muted); }
    .mt-bar { height: 6px; background: rgba(0,0,0,0.4); border-radius: 3px; overflow: hidden; }
    .mt-fill { height: 100%; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); }

    .guide-accordion { background: var(--bg-panel); border: 1px solid var(--border); border-radius: 12px; margin-bottom: 16px; overflow: hidden; transition: all 0.3s ease; }
    .guide-accordion:hover { border-color: rgba(255,255,255,0.15); }
    .guide-accordion.open { border-color: var(--border-hover); box-shadow: 0 8px 24px rgba(0,0,0,0.2); }
    .guide-accordion.mastered { border-color: rgba(34,197,94,0.3); }
    .ga-header { padding: 20px 24px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; user-select: none; }
    .ga-title-area { display: flex; align-items: center; gap: 16px; flex: 1; }
    .ga-check { width: 24px; height: 24px; border: 1px solid; border-radius: 6px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: all 0.2s; }
    .ga-title { font-family: 'Inter', sans-serif; font-size: 16px; font-weight: 600; color: white; margin-bottom: 4px; }
    .ga-summary { font-size: 13px; color: var(--muted); line-height: 1.5; margin: 0; }
    .ga-chevron { font-family: 'DM Mono', monospace; font-size: 20px; color: var(--muted); padding-left: 16px;}
    .ga-body { border-top: 1px solid rgba(255,255,255,0.05); background: rgba(0,0,0,0.2); }
    .ga-content { padding: 24px; font-size: 15px; line-height: 1.7; color: var(--text); }
    
    .view-toggle { display: flex; background: rgba(0,0,0,0.4); padding: 4px; border-radius: 8px; margin-bottom: 20px; width: fit-content; }
    .view-toggle button { background: transparent; border: none; color: var(--muted); padding: 8px 16px; border-radius: 6px; font-family: 'DM Mono', monospace; font-size: 12px; cursor: pointer; transition: all 0.2s; }
    .view-toggle button.active { background: rgba(0, 118, 206, 0.2); color: #60A5FA; border: 1px solid rgba(0, 118, 206, 0.4); }
    .view-toggle button.locked-btn { opacity: 0.5; cursor: not-allowed; }

    .ga-how { margin-bottom: 20px; min-height: 60px; }
    .ga-takeaway { background: rgba(0, 118, 206, 0.1); border: 1px solid rgba(0, 118, 206, 0.2); border-radius: 8px; padding: 16px; color: #BAE6FD; margin-bottom: 24px; }
    .img-placeholder { margin-top: 20px; padding: 16px; border: 1px dashed rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: #93C5FD; font-family: 'DM Mono', monospace; font-size: 12px; text-align: center; border-radius: 8px;}
    
    .ga-actions { padding: 0 24px 24px 24px; display: flex; justify-content: flex-end; }
    .btn-mastery { background: transparent; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; padding: 10px 16px; font-family: 'DM Mono', monospace; font-size: 12px; color: var(--text); cursor: pointer; transition: all 0.2s; }
    .btn-mastery:hover { background: rgba(255,255,255,0.05); }
    .btn-mastery.active { background: rgba(34,197,94,0.1); border-color: #22C55E; color: #22C55E; }

    .exam-bar { display: flex; align-items: center; gap: 16px; padding: 12px 24px; margin-bottom: 24px; }
    .timer { font-family: 'DM Mono', monospace; font-size: 18px; font-weight: 500; color: #00AEEF; }
    .timer.danger { color: #EF4444; }
    .exam-progress { font-family: 'DM Mono', monospace; font-size: 13px; color: var(--muted); }
    .quiz-header { display: flex; align-items: center; gap: 16px; margin-bottom: 32px; padding: 16px 24px; }
    .quiz-back { background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: var(--text); padding: 10px 16px; border-radius: 8px; cursor: pointer; font-size: 13px; font-family: 'DM Mono', monospace; transition: background 0.2s; }
    .quiz-back:hover { background: rgba(255,255,255,0.1); }
    .quiz-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 16px; flex: 1; color: white; }
    .quiz-progress-text { font-family: 'DM Mono', monospace; font-size: 13px; color: var(--muted); }
    .progress-bar { height: 4px; background: rgba(255,255,255,0.06); border-radius: 2px; margin-bottom: 32px; overflow: hidden; }
    .progress-fill { height: 100%; border-radius: 2px; transition: width 0.4s ease; }
    .question-card { padding: 48px 40px; margin-bottom: 24px; }
    .q-num { font-family: 'DM Mono', monospace; font-size: 12px; color: var(--muted); letter-spacing: 1.5px; margin-bottom: 24px; }
    .q-text { font-family: 'Inter', sans-serif; font-size: 20px; font-weight: 500; line-height: 1.6; margin-bottom: 40px; color: white; }
    .options { display: flex; flex-direction: column; gap: 14px; }
    .option-btn { display: flex; align-items: center; gap: 16px; background: rgba(255,255,255,0.02); border: 1px solid var(--border); border-radius: 12px; padding: 16px 20px; cursor: pointer; text-align: left; width: 100%; transition: all 0.2s; color: var(--text); min-height: 64px; }
    .option-btn:hover:not(:disabled) { border-color: var(--primary); background: rgba(0, 118, 206, 0.08); transform: translateX(6px); }
    .option-btn:disabled { cursor: default; }
    .option-btn.correct { background: rgba(34,197,94,0.12); border-color: rgba(34,197,94,0.6); color: #86EFAC; }
    .option-btn.wrong { background: rgba(239,68,68,0.12); border-color: rgba(239,68,68,0.6); color: #FCA5A5; }
    .option-letter { font-family: 'DM Mono', monospace; font-size: 14px; font-weight: 500; width: 32px; height: 32px; border-radius: 8px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .option-text { font-size: 15px; line-height: 1.5; }
    .rationale { background: rgba(0, 118, 206, 0.15); border: 1px solid rgba(0, 118, 206, 0.3); border-radius: 12px; padding: 24px; margin-top: 32px; font-size: 15px; line-height: 1.6; color: #BAE6FD; }
    .keyboard-hint { display: none; }
    .quiz-actions { display: flex; justify-content: center; margin-top: 8px; }

    .results-card { padding: 56px 40px; text-align: center; margin-bottom: 32px; display: flex; flex-direction: column; align-items: center; }
    .results-score { font-family: 'Syne', sans-serif; font-size: 96px; font-weight: 800; line-height: 1; margin-bottom: 12px; }
    .results-grade { font-size: 20px; color: var(--muted); margin-bottom: 24px; font-weight: 600; letter-spacing: 1px; }
    .review-item { padding: 24px; display: flex; gap: 16px; align-items: flex-start; margin-bottom: 16px; }
    .review-icon { font-size: 20px; flex-shrink: 0; margin-top: 2px; }
    .review-q { font-size: 14px; line-height: 1.5; }

    .search-bar { width: 100%; padding: 18px 24px; color: white; font-size: 16px; margin-bottom: 40px; font-family: 'Inter', sans-serif; outline: none; transition: all 0.2s; }
    .search-bar:focus { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(0, 118, 206, 0.2); }
    .gloss-section-title { font-family: 'DM Mono', monospace; font-size: 12px; color: var(--muted); letter-spacing: 2px; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
    .gloss-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 16px; margin-bottom: 48px; }
    .gloss-item { padding: 20px 24px; }
    .gloss-term { font-family: 'DM Mono', monospace; font-size: 14px; font-weight: 500; color: #60A5FA; margin-bottom: 10px; }
    .gloss-def { font-size: 14px; color: var(--muted); line-height: 1.5; }
    
    .quick-ref-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 16px; margin-bottom: 48px; }
    .qr-card { padding: 20px; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @media (min-width: 768px) { .keyboard-hint { display: inline-block; font-size: 11px; color: rgba(255,255,255,0.5); margin-left: 12px; } }
    @media (max-width: 850px) { .guide-layout { flex-direction: column; padding: 24px 16px; } .guide-sidebar { width: 100%; position: static; display: flex; flex-wrap: wrap; gap: 8px; padding: 16px; } .sidebar-btn { width: auto; flex: 1; min-width: 140px; } }
    @media (max-width: 600px) { .nav { padding: 0 16px; height: 80px; flex-wrap: wrap;} .nav-actions { margin-left: 0; width: 100%; display: flex; justify-content: flex-end; padding-bottom: 8px;} .home, .quiz-wrap, .glossary-wrap { padding: 32px 16px 80px; } .hero-title { font-size: 32px; } .stat-card { min-width: 120px; } .question-card { padding: 32px 24px; } .option-btn { padding: 14px 16px; min-height: 56px; gap: 12px; } .results-score { font-size: 64px; } .gloss-grid, .quick-ref-grid { grid-template-columns: 1fr; } .flashcard { height: 400px; } .fc-term { font-size: 28px; } .readiness-panel { flex-direction: column; text-align: center; gap: 16px; } }
  </style>
</body>
</html>
